!function($){$.fn.cardtable=function(options){var headIndex,$tables=this,defaults={headIndex:0},settings=$.extend({},defaults,options);return headIndex=options&&options.headIndex?options.headIndex:0,$tables.each(function(){var $table=$(this);if(!$table.hasClass("stacktable")){var table_css=$(this).prop("class"),$stacktable=$("<div></div>");"undefined"!=typeof settings.myClass&&$stacktable.addClass(settings.myClass);var $caption,$topRow,headMarkup,bodyMarkup,tr_class,markup="";$table.addClass("stacktable large-only"),$caption=$table.find(">caption").clone(),$topRow=$table.find(">thead>tr,>tbody>tr,>tfoot>tr,>tr").eq(0),$table.siblings().filter(".small-only").remove(),$table.find(">tbody>tr").each(function(){headMarkup="",bodyMarkup="",tr_class=$(this).prop("class"),$(this).find(">td,>th").each(function(cellIndex){""!==$(this).html()&&(bodyMarkup+='<tr class="'+tr_class+'">',bodyMarkup+=$topRow.find(">td,>th").eq(cellIndex).html()?'<td class="st-key">'+$topRow.find(">td,>th").eq(cellIndex).html()+"</td>":'<td class="st-key"></td>',bodyMarkup+='<td class="st-val '+$(this).prop("class")+'">'+$(this).html()+"</td>",bodyMarkup+="</tr>")}),markup+='<table class=" '+table_css+' stacktable small-only"><tbody>'+headMarkup+bodyMarkup+"</tbody></table>"}),$table.find(">tfoot>tr>td").each(function(rowIndex,value){""!==$.trim($(value).text())&&(markup+='<table class="'+table_css+' stacktable small-only"><tbody><tr><td>'+$(value).html()+"</td></tr></tbody></table>")}),$stacktable.prepend($caption),$stacktable.append($(markup)),$table.before($stacktable)}})},$.fn.stacktable=function(options){var headIndex,$tables=this,defaults={headIndex:0,displayHeader:!0},settings=$.extend({},defaults,options);return headIndex=options&&options.headIndex?options.headIndex:0,$tables.each(function(){var table_css=$(this).prop("class"),$stacktable=$('<table class="'+table_css+' stacktable small-only"><tbody></tbody></table>');"undefined"!=typeof settings.myClass&&$stacktable.addClass(settings.myClass);var $table,$caption,$topRow,headMarkup,bodyMarkup,tr_class,displayHeader,markup="";$table=$(this),$table.addClass("stacktable large-only"),$caption=$table.find(">caption").clone(),$topRow=$table.find(">thead>tr,>tbody>tr,>tfoot>tr").eq(0),displayHeader=void 0===$table.data("display-header")?settings.displayHeader:$table.data("display-header"),$table.find(">tbody>tr").each(function(rowIndex){headMarkup="",bodyMarkup="",tr_class=$(this).prop("class"),0===rowIndex?displayHeader&&(markup+='<tr class=" '+tr_class+' "><th class="st-head-row st-head-row-main" colspan="2">'+$(this).find(">th,>td").eq(headIndex).html()+"</th></tr>"):($(this).find(">td,>th").each(function(cellIndex){cellIndex===headIndex?headMarkup='<tr class="'+tr_class+'"><th class="st-head-row" colspan="2">'+$(this).html()+"</th></tr>":""!==$(this).html()&&(bodyMarkup+='<tr class="'+tr_class+'">',bodyMarkup+=$topRow.find(">td,>th").eq(cellIndex).html()?'<td class="st-key">'+$topRow.find(">td,>th").eq(cellIndex).html()+"</td>":'<td class="st-key"></td>',bodyMarkup+='<td class="st-val '+$(this).prop("class")+'">'+$(this).html()+"</td>",bodyMarkup+="</tr>")}),markup+=headMarkup+bodyMarkup)}),$stacktable.prepend($caption),$stacktable.append($(markup)),$table.before($stacktable)})},$.fn.stackcolumns=function(options){var $tables=this,defaults={},settings=$.extend({},defaults,options);return $tables.each(function(){var $table=$(this),$caption=$table.find(">caption").clone(),num_cols=$table.find(">thead>tr,>tbody>tr,>tfoot>tr").eq(0).find(">td,>th").length;if(!(num_cols<3)){var $stackcolumns=$('<table class="stacktable small-only"></table>');"undefined"!=typeof settings.myClass&&$stackcolumns.addClass(settings.myClass),$table.addClass("stacktable large-only");for(var tb=$("<tbody></tbody>"),col_i=1;col_i<num_cols;)$table.find(">thead>tr,>tbody>tr,>tfoot>tr").each(function(index){var tem=$("<tr></tr>");0===index&&tem.addClass("st-head-row st-head-row-main");var first=$(this).find(">td,>th").eq(0).clone().addClass("st-key"),target=col_i;if($(this).find("*[colspan]").length){var i=0;$(this).find(">td,>th").each(function(){var cs=$(this).attr("colspan");if(cs?(cs=parseInt(cs,10),target-=cs-1,i+cs>col_i&&(target+=i+cs-col_i-1),i+=cs):i++,i>col_i)return!1})}var second=$(this).find(">td,>th").eq(target).clone().addClass("st-val").removeAttr("colspan");tem.append(first,second),tb.append(tem)}),++col_i;$stackcolumns.append($(tb)),$stackcolumns.prepend($caption),$table.before($stackcolumns)}})}}(jQuery);
